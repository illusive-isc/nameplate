import"../chunks/DsnmJJEf.js";import{i as ha}from"../chunks/DseWiG4g.js";import{o as ma,a as ga,e as me}from"../chunks/kt2oo5dz.js";import{h as Y,k as ba,j as xa,K as r,X as _a,r as ya,H as wa,l as Le,m as Ve,o as Te,z as ce,Y as Ta,Z as Ca,u as ke,w as Ia,v as re,_ as $e,$ as Ea,p as Sa,a0 as P,a1 as Ge,a2 as ka,x as Je,y as Aa,a3 as Ra,a4 as Ce,a5 as je,a6 as Ha,a7 as Ma,a8 as Da,a9 as Na,aa as Oa,ab as Pa,ac as Wa,ad as ea,ae as Xa,C as aa,B as ta,af as qa,Q as za,i as Re,e as ge,R as Ya,W as b,T as k,ag as N,V as A,ah as Ua,ai as Be,aj as Fe,c as La,f as Va,t as Ga}from"../chunks/b-yk2inY.js";import{b as Ba,i as Ke}from"../chunks/Dh2UNPU_.js";import{r as J,s as Fa}from"../chunks/ttF274cl.js";function Ka(e,l){return l}function Qa(e,l,t){for(var c=e.items,i=[],s=l.length,m=0;m<s;m++)Na(l[m].e,i,!0);var g=s>0&&i.length===0&&t!==null;if(g){var x=t.parentNode;Oa(x),x.append(t),c.clear(),z(e,l[0].prev,l[s-1].next)}Pa(i,()=>{for(var M=0;M<s;M++){var p=l[M];g||(c.delete(p.k),z(e,p.prev,p.next)),je(p.e,!g)}})}function Za(e,l,t,c,i,s=null){var m=e,g={flags:l,items:new Map,first:null};Y&&ba();var x=null,M=!1,p=new Map,O=_a(()=>{var n=t();return Ea(n)?n:n==null?[]:$e(n)}),o,_;function u(){$a(_,o,g,p,m,i,l,c,t),s!==null&&(o.length===0?x?Je(x):x=ke(()=>s(m)):x!==null&&Aa(x,()=>{x=null}))}xa(()=>{_??=Wa,o=r(O);var n=o.length;if(M&&n===0)return;M=n===0;let h=!1;if(Y){var y=ya(m)===wa;y!==(n===0)&&(m=Le(),Ve(m),Te(!1),h=!0)}if(Y){for(var E=null,v,f=0;f<n;f++){if(ce.nodeType===Ta&&ce.data===Ca){m=ce,h=!0,Te(!1);break}var w=o[f],C=c(w,f);v=Ae(ce,g,E,null,w,C,f,i,l,t),g.items.set(C,v),E=v}n>0&&Ve(Le())}if(Y)n===0&&s&&(x=ke(()=>s(m)));else if(Ia()){var K=new Set,W=re;for(f=0;f<n;f+=1){w=o[f],C=c(w,f);var I=g.items.get(C)??p.get(C);I?la(I,w,f):(v=Ae(null,g,null,null,w,C,f,i,l,t,!0),p.set(C,v)),K.add(C)}for(const[U,G]of g.items)K.has(U)||W.skipped_effects.add(G.e);W.add_callback(u)}else u();h&&Te(!0),r(O)}),Y&&(m=ce)}function $a(e,l,t,c,i,s,m,g,x){var M=l.length,p=t.items,O=t.first,o=O,_,u=null,n=[],h=[],y,E,v,f;for(f=0;f<M;f+=1){if(y=l[f],E=g(y,f),v=p.get(E),v===void 0){var w=c.get(E);if(w!==void 0){c.delete(E),p.set(E,w);var C=u?u.next:o;z(t,u,w),z(t,w,C),Ie(w,C,i),u=w}else{var K=o?o.e.nodes_start:i;u=Ae(K,t,u,u===null?t.first:u.next,y,E,f,s,m,x)}p.set(E,u),n=[],h=[],o=u.next;continue}if(la(v,y,f),(v.e.f&Ce)!==0&&Je(v.e),v!==o){if(_!==void 0&&_.has(v)){if(n.length<h.length){var W=h[0],I;u=W.prev;var U=n[0],G=n[n.length-1];for(I=0;I<n.length;I+=1)Ie(n[I],W,i);for(I=0;I<h.length;I+=1)_.delete(h[I]);z(t,U.prev,G.next),z(t,u,U),z(t,G,W),o=W,u=G,f-=1,n=[],h=[]}else _.delete(v),Ie(v,o,i),z(t,v.prev,v.next),z(t,v,u===null?t.first:u.next),z(t,u,v),u=v;continue}for(n=[],h=[];o!==null&&o.k!==E;)(o.e.f&Ce)===0&&(_??=new Set).add(o),h.push(o),o=o.next;if(o===null)continue;v=o}n.push(v),u=v,o=v.next}if(o!==null||_!==void 0){for(var ie=_===void 0?[]:$e(_);o!==null;)(o.e.f&Ce)===0&&ie.push(o),o=o.next;var be=ie.length;if(be>0){var ne=null;Qa(t,ie,ne)}}e.first=t.first&&t.first.e,e.last=u&&u.e;for(var de of c.values())je(de.e);c.clear()}function la(e,l,t,c){ka(e.v,l),e.i=t}function Ae(e,l,t,c,i,s,m,g,x,M,p){var O=(x&Ha)!==0,o=(x&Ma)===0,_=O?o?P(i,!1,!1):Ge(i):i,u=(x&Ra)===0?m:Ge(m),n={i:u,v:_,k:s,a:null,e:null,prev:t,next:c};try{if(e===null){var h=document.createDocumentFragment();h.append(e=Sa())}return n.e=ke(()=>g(e,_,u,M),Y),n.e.prev=t&&t.e,n.e.next=c&&c.e,t===null?p||(l.first=n):(t.next=n,t.e.next=n.e),c!==null&&(c.prev=n,c.e.prev=n.e),n}finally{}}function Ie(e,l,t){for(var c=e.next?e.next.e.nodes_start:t,i=l?l.e.nodes_start:t,s=e.e.nodes_start;s!==null&&s!==c;){var m=Da(s);i.before(s),s=m}}function z(e,l,t){l===null?e.first=t:(l.next=t,l.e.next=t&&t.e),t!==null&&(t.prev=l,t.e.prev=l&&l.e)}function Ja(e,l){return e==null?null:String(e)}function Qe(e,l,t,c){var i=e.__style;if(Y||i!==l){var s=Ja(l);(!Y||s!==e.getAttribute("style"))&&(s==null?e.removeAttribute("style"):e.style.cssText=s),e.__style=l}return c}function le(e,l,t=l){var c=new WeakSet;ea(e,"input",async i=>{var s=i?e.defaultValue:e.value;if(s=Ee(e)?Se(s):s,t(s),re!==null&&c.add(re),await Xa(),s!==(s=l())){var m=e.selectionStart,g=e.selectionEnd;e.value=s??"",g!==null&&(e.selectionStart=m,e.selectionEnd=Math.min(g,e.value.length))}}),(Y&&e.defaultValue!==e.value||aa(l)==null&&e.value)&&(t(Ee(e)?Se(e.value):e.value),re!==null&&c.add(re)),ta(()=>{var i=l();if(e===document.activeElement){var s=qa??re;if(c.has(s))return}Ee(e)&&i===Se(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function Ze(e,l,t=l){ea(e,"change",c=>{var i=c?e.defaultChecked:e.checked;t(i)}),(Y&&e.defaultChecked!==e.checked||aa(l)==null)&&t(e.checked),ta(()=>{var c=l();e.checked=!!c})}function Ee(e){var l=e.type;return l==="number"||l==="range"}function Se(e){return e===""?null:+e}var ja=Re('<img alt="icon" width="32" height="32" style="border-radius:50%; border:1.5px solid #ccc; cursor:pointer; background:#fff; object-fit:cover;" title="クリックで復元"/>'),et=Re('<div style="margin-top:0.4em; display:flex; flex-wrap:wrap; gap:0.5em;"><span style="font-size:0.92em; color:#888;">履歴:</span> <!></div>'),at=Re('<div style="display: flex; flex-direction: row; align-items: flex-start; gap: 2.5em; margin-bottom: 2em;"><canvas style="border-radius:16px; box-shadow:0 2px 8px #0001;"></canvas> <div style="display: flex; flex-direction: column; gap: 0.9em; max-width: 340px; min-width: 220px;"><label style="display: flex; flex-direction: column; font-weight: bold; gap: 0.2em;">アイコン画像 <input type="text" placeholder="画像URLを入力" style="width:100%; padding: 4px 8px; border-radius: 6px; border: 1px solid #ccc; margin-bottom: 0.3em;"/> <input type="file" accept="image/*" style="padding: 2px 0;"/> <span style="font-size:0.92em; color:#888;">URLまたは画像ファイルを選択</span> <!></label> <label style="display: flex; flex-direction: column; font-weight: bold; gap: 0.2em;">名前 <input style="width:100%; padding: 4px 8px; border-radius: 6px; border: 1px solid #ccc;"/></label> <label style="display: flex; flex-direction: column; font-weight: bold; gap: 0.2em;">ID <div style="display: flex; align-items: center; gap: 0.3em;"><span style="color:#888; font-size:1.1em;">@</span> <input style="flex:1; padding: 4px 8px; border-radius: 6px; border: 1px solid #ccc; min-width:0;"/></div></label> <label style="display: flex; flex-direction: column; font-weight: bold; gap: 0.2em;">日付 <input style="width:100%; padding: 4px 8px; border-radius: 6px; border: 1px solid #ccc;"/></label> <label>本文 <textarea rows="3" style="width:100%; padding: 4px 8px; border-radius: 6px; border: 1px solid #ccc; resize: vertical; font-family: inherit; font-size: 1em;"></textarea></label> <label>タイトル <input style="width:100%; padding: 4px 8px; border-radius: 6px; border: 1px solid #ccc;"/></label> <div style="display:flex; gap:1.5em; align-items:center; margin-bottom:0.5em;"><label style="font-weight:bold; display:flex; align-items:center; gap:0.6em;"><input type="checkbox"/> リツイート</label> <label style="font-weight:bold; display:flex; align-items:center; gap:0.6em;"><input type="checkbox"/> いいね</label></div> <div style="margin-top: 0.7em;"><button style="padding: 6px 18px; border-radius: 6px; background: #222; color: #fff; border: none; font-weight: bold; cursor: pointer;">画像をクリップボードにコピー</button></div></div></div>');function ot(e,l){za(l,!1);let t=P(!0),c=P(!0),i=P("https://pbs.twimg.com/profile_images/1883413777074487296/MHN6aWvh_400x400.jpg"),s=P([r(i)]);const m=5;function g(d){d&&N(s,[d,...r(s).filter(S=>S!==d)].slice(0,m))}function x(d){const S=d.target.files&&d.target.files[0];if(!S)return;const B=new FileReader;B.onload=j=>{N(i,j.target.result),g(r(i))},B.readAsDataURL(S)}async function M(){if(r(p))try{r(p).toBlob(async d=>{if(d)try{await navigator.clipboard.write([new window.ClipboardItem({"image/png":d})]),alert("画像をクリップボードにコピーしました")}catch(S){alert("クリップボードへのコピーに失敗しました: "+S)}},"image/png")}catch(d){alert("クリップボードAPIが使えません: "+d)}}let p=P(),O=P("illusive"),o=P("illusive_isc"),_=P("現在"),u=P("Svelteで画像投稿風キャンバス"),n=P(`ツイート本文の例です。改行もできます。
さらに長い文章の場合は自動的に折り返されます`);const h=500,y=80,E=56,v=20,f=18;function w(){const d=h-v*2,S=d;let B=0,j=0;const ee=26,se=y,ve=h-se-24;{const oe=document.createElement("canvas").getContext("2d");if(oe.font="18px sans-serif",r(n)){const Q=r(n).split(/\r?\n/);for(let Z of Q)do{let $=Z.length;for(;oe.measureText(Z.slice(0,$)).width>ve&&$>0;)$--;B++,Z=Z.slice($)}while(Z.length>0)}else B=1;j=B*ee}const pe=y+j-30;Math.round((r(p).height-S)/2);const D=pe+S+E+v;Fe(p,r(p).width=h),Fe(p,r(p).height=D);const a=r(p).getContext("2d");{if(a.fillStyle="#fff",a.strokeStyle="#e1e8ed",a.lineWidth=1,a.beginPath(),a.moveTo(f,0),a.lineTo(h-f,0),a.quadraticCurveTo(h,0,h,f),a.lineTo(h,D-f),a.quadraticCurveTo(h,D,h-f,D),a.lineTo(f,D),a.quadraticCurveTo(0,D,0,D-f),a.lineTo(0,f),a.quadraticCurveTo(0,0,f,0),a.closePath(),a.fill(),a.stroke(),r(i)){const F=new window.Image;F.crossOrigin="anonymous",F.src=r(i),F.onload=()=>{a.save(),a.beginPath(),a.arc(y/2,y/2,28,0,Math.PI*2),a.closePath(),a.clip(),a.drawImage(F,y/2-28,y/2-28,56,56),a.restore()}}else a.save(),a.beginPath(),a.arc(y/2,y/2,28,0,Math.PI*2),a.closePath(),a.clip(),a.fillStyle="#1da1f2",a.fill(),a.restore();const oe=y,Q=38;a.font="bold 20px sans-serif",a.fillStyle="#222",a.fillText(r(O),oe,Q);const Z=a.measureText(r(O)).width;a.font="16px sans-serif",a.fillStyle="#555";const $=oe+Z+16;a.fillText("@"+r(o),$,Q);const ia=a.measureText("@"+r(o)).width;a.font="14px sans-serif",a.fillStyle="#888";const ze="·",Ye=$+ia+12;a.fillText(ze,Ye,Q);const na=a.measureText(ze).width,sa=Ye+na+4;a.fillText(r(_),sa,Q),a.font="18px sans-serif",a.fillStyle="#222";let Ue=Q+24;if(r(n)){const F=r(n).split(/\r?\n/);for(let X of F)do{let V=X.length;for(;a.measureText(X.slice(0,V)).width>ve&&V>0;)V--;a.fillText(X.slice(0,V),se,Ue),X=X.slice(V),Ue+=ee}while(X.length>0)}a.save(),a.globalCompositeOperation="destination-out",a.beginPath();const L=18,R=v+50,H=pe,ae=d-50,te=S;a.moveTo(R+L,H),a.lineTo(R+ae-L,H),a.quadraticCurveTo(R+ae,H,R+ae,H+L),a.lineTo(R+ae,H+te-L),a.quadraticCurveTo(R+ae,H+te,R+ae-L,H+te),a.lineTo(R+L,H+te),a.quadraticCurveTo(R,H+te,R,H+te-L),a.lineTo(R,H+L),a.quadraticCurveTo(R,H,R+L,H),a.closePath(),a.fillStyle="rgba(0,0,0,1)",a.fill(),a.restore();const oa=D-E/1.5,T=28,ca=[0,80,80,80,100,40],da=["/src/lib/assets/coment.png","/src/lib/assets/repost.png",r(c)?"/src/lib/assets/heart_2.png":"/src/lib/assets/heart.png","/src/lib/assets/hyouzi.png","/src/lib/assets/bookmark.png","/src/lib/assets/uploadarrow.png"],fa=90;da.forEach((F,X)=>{const V=new window.Image;V.src=F,V.onload=()=>{const he=document.createElement("canvas");he.width=T,he.height=T;const q=he.getContext("2d");q.clearRect(0,0,T,T),q.drawImage(V,0,0,T,T),q.globalCompositeOperation="source-in",X===1?(q.fillStyle=r(t)?"#7be87b":"#222",q.fillRect(0,0,T,T)):X===2?(q.fillStyle=r(c)?"#e1306c":"#222",q.fillRect(0,0,T,T)):(q.fillStyle="#222",q.fillRect(0,0,T,T)),q.globalCompositeOperation="source-over";const ua=fa+ca.slice(0,X+1).reduce((va,pa)=>va+pa,0)-T/2;a.drawImage(he,ua,oa-T/2,T,T)}})}}ma(w),ga(w),ha();var C=at(),K=k(C);Ba(K,d=>N(p,d),()=>r(p));var W=b(K,2),I=k(W),U=b(k(I));J(U);var G=b(U,2),ie=b(G,4);{var be=d=>{var S=et(),B=b(k(S),2);Za(B,1,()=>r(s),Ka,(j,ee)=>{var se=La(),ve=Va(se);{var pe=D=>{var a=ja();Ga(()=>Fa(a,"src",r(ee))),me("click",a,()=>N(i,r(ee))),ge(D,a)};Ke(ve,D=>{r(ee)!==r(i)&&D(pe)})}ge(j,se)}),A(S),ge(d,S)};Ke(ie,d=>{r(s).length>1&&d(be)})}A(I);var ne=b(I,2),de=b(k(ne));J(de),A(ne);var xe=b(ne,2),He=b(k(xe)),Me=b(k(He),2);J(Me),A(He),A(xe);var _e=b(xe,2),De=b(k(_e));J(De),A(_e);var fe=b(_e,2);Qe(fe,"flex-direction: column; font-weight: bold; gap: 0.2em; display:flex;");var Ne=b(k(fe));Ua(Ne),A(fe);var ue=b(fe,2);Qe(ue,"flex-direction: column; font-weight: bold; gap: 0.2em; display:none;");var Oe=b(k(ue));J(Oe),A(ue);var ye=b(ue,2),we=k(ye),Pe=k(we);J(Pe),Be(),A(we);var We=b(we,2),Xe=k(We);J(Xe),Be(),A(We),A(ye);var qe=b(ye,2),ra=k(qe);A(qe),A(W),A(C),le(U,()=>r(i),d=>N(i,d)),me("blur",U,()=>g(r(i))),me("change",G,x),le(de,()=>r(O),d=>N(O,d)),le(Me,()=>r(o),d=>N(o,d)),le(De,()=>r(_),d=>N(_,d)),le(Ne,()=>r(n),d=>N(n,d)),le(Oe,()=>r(u),d=>N(u,d)),Ze(Pe,()=>r(t),d=>N(t,d)),Ze(Xe,()=>r(c),d=>N(c,d)),me("click",ra,M),ge(e,C),Ya()}export{ot as component};
